<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
	<title>{#umbraco_dlg.code_title}</title>
	<script type="text/javascript" src="../../tiny_mce_popup.js"></script>
	<script type="text/javascript" src="js/source_editor.js"></script>
	<script type="text/javascript" src="/umbraco_client/ui/jquery.js"></script>
	<script type="text/javascript" src="/umbraco_client/Application/NamespaceManager.js"></script>
	<script type="text/javascript" src="/umbraco_client/CodeArea/UmbracoEditor.js"></script>
	<script type="text/javascript" src="/umbraco_client/CodeMirror/js/lib/codemirror.js"></script>
	<script type="text/javascript" src="/umbraco_client/CodeMirror/js/mode/xml/xml.js"></script>
	<script type="text/javascript" src="/umbraco_client/CodeArea/javascript.js"></script>
	<link href="/umbraco_client/CodeMirror/js/lib/codemirror.css" type="text/css" rel="stylesheet">
	<link href="/umbraco_client/CodeMirror/css/umbracoCustom.css" type="text/css" rel="stylesheet">
	<link href="/umbraco_client/CodeArea/styles.css" type="text/css" rel="stylesheet">
	
	<script type="text/javascript">
					//TODO: for now this is a global var, need to refactor all this so that is using proper js standards
					//with correct objects, and proper accessors to these objects.
					var codeEditor;               
                    $(document).ready(function () {
					setTimeout(function() {
                                var textarea = document.getElementById('htmlSource');
                                codeEditor = CodeMirror.fromTextArea(textarea, {
                                                mode: {name: "xml", htmlMode: true},
                                                width: "100%",
                                                height: "90%",
                                                tabMode: "shift",
                                                matchBrackets: true,
                                                indentUnit: 4,
                                                indentWithTabs: true,
                                                enterMode: "keep",
                                                onCursorActivity: updateLineInfo,
                                                lineWrapping: true,
                                                lineNumbers: true
                                                });
                                  
								  
                                    updateLineInfo(codeEditor);
									
									$(".CodeMirror").height($("#htmlSource").height());
									$(".CodeMirror").width($("#htmlSource").width());
									}, 500);
                    });</script>
	
	<base target="_self" />
</head>
<body onresize="resizeInputs();" style="display:none; overflow:hidden;">
	<form name="source" onsubmit="saveContent();return false;" action="#">
	
		<div style="float: left; display: none;" class="title"><label for="htmlSource">{#umbraco_dlg.code_title}</label></div>
		<div id="wrapline" style="display: none; float: right">
			<input type="checkbox" name="wraped" id="wraped" onclick="toggleWordWrap(this);" class="wordWrapCode" /><label for="wraped">{#umbraco_dlg.code_wordwrap}</label>
		</div>

		<br style="clear: both" />

		<textarea name="htmlSource" id="htmlSource" rows="15" cols="100" style="width: 100%; height: 100%; font-family: 'Courier New',Courier,monospace; font-size: 12px;" dir="ltr" wrap="off" class="mceFocus"></textarea>

		<div class="mceActionPanel">
			<input type="submit" role="button" name="insert" value="{#update}" id="insert" onclick="codeEditor.toTextArea();" />
			<input type="button" role="button" name="cancel" value="{#cancel}" onclick="tinyMCEPopup.close();" id="cancel" />
		</div>
	</form>
</body>
</html>
        