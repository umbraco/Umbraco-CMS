<div ng-controller="Umbraco.Editors.Content.RollbackController as vm">

    <div class="umb-dialog-body" ng-cloak>

        <umb-load-indicator ng-if="vm.loading"></umb-load-indicator>

        <div class="umb-pane" ng-show="!vm.loading">

            <div>
                <h5>Rollback {{ currentNode.name }}</h5>
            
                <h5><localize key="rollback_currentVersion"></localize></h5>
                <p>{{vm.currentVersion.name}} (Created: {{vm.currentVersion.createDate}})</p>
                
                <h5><localize key="rollback_rollbackTo"></localize></h5>
                <select 
                    class="input-block-level"
                    ng-model="vm.selectedVersion"
                    ng-options="version.createDate for version in vm.previousVersions track by version.id"
                    ng-change="vm.loadVersion(vm.selectedVersion.id)">
                    <option value=""><localize key="general_choose">Choose</localize>...</option>
                </select>
            </div>

            <div ng-if="vm.diff" class="diff" style="border-top: 1px solid #e9e9eb; margin-top: 30px;">

                <h5>Changes</h5>
                <small style="margin-bottom: 15px; display: block;"><localize key="rollback_diffHelp"></localize></small>

                <table class="table table-condensed table-bordered">
                    <tbody>
                        <tr>
                            <td class="bold">Name</td>
                            <td>
                                <span ng-repeat="part in vm.diff.name">
                                    <ins ng-if="part.added">{{part.value}}</ins>
                                    <del ng-if="part.removed">{{part.value}}</del>
                                    <span ng-if="!part.added && !part.removed">{{part.value}}</span>
                                </span>
                            </td>
                        </tr>
                        <tr ng-repeat="property in vm.diff.properties track by property.alias">
                            <td class="bold">{{property.label}}</td>
                            <td>
                                <span ng-repeat="part in property.diff">
                                    <ins ng-if="part.added">{{part.value}}</ins>
                                    <del ng-if="part.removed">{{part.value}}</del>
                                    <span ng-if="!part.added && !part.removed">{{part.value}}</span>
                                </span>
                            </td>
                        </tr>
                    </tbody>
                </table>

            </div>
                
        </div>
    </div>

    <div class="umb-dialog-footer btn-toolbar umb-btn-toolbar">

        <umb-button
            label-key="general_close"
            disabled="vm.saveState === 'busy'"
            action="vm.closeDialog()"
            type="button"
            button-style="link">
        </umb-button>

        <umb-button
            label-key="buttons_rollback"
            disabled="vm.saveState === 'busy'"
            state="vm.saveState"
            action="vm.rollback()"
            type="button"
            button-style="success">
        </umb-button>
    </div>

</div>