<div ng-controller="Umbraco.Dialogs.LoginController">
    <div id="login" class="umb-modalcolumn" ng-class="{'show-validation': loginForm.$invalid}" ng-cloak>
        <div class="form">
            <h1>{{greeting}}</h1>

            <div ng-show="view == 'login'">
                
                <p>
                    <span ng-show="dialogData.isTimedOut"><localize key="login_timeout">Log in below</localize>.</span>
                    <localize key="login_instruction">Log in below</localize>
                </p>

                <div class="external-logins" ng-if="externalLoginProviders.length > 0">

                    <div class="alert alert-error" ng-repeat="error in externalLoginInfo.errors">
                        <span>{{error}}</span>
                    </div>

                    <form method="POST" name="externalLoginForm" action="{{externalLoginFormAction}}">

                        <div ng-repeat="login in externalLoginProviders">

                            <button type="submit" class="btn btn-block btn-social"
                                    ng-class="login.properties.SocialStyle"
                                    id="{{login.authType}}" name="provider" value="{{login.authType}}"
                                    title="Log in using your {{login.caption}} account">
                                <i class="fa" ng-class="login.properties.SocialIcon"></i>
                                Sign in with {{login.caption}}
                            </button>

                        </div>
                    </form>

                    <div id="hrOr">
                        <hr/>
                        <div>Or</div>
                    </div>

                </div>

                <form method="POST" name="loginForm" ng-submit="loginSubmit(login, password)">
                    <div class="control-group" ng-class="{error: loginForm.username.$invalid}">
                        <input type="text" autofocus ng-model="login" name="username" class="input-xlarge" localize="placeholder" placeholder="@placeholders_username"/>
                    </div>

                    <div class="control-group" ng-class="{error: loginForm.password.$invalid}">
                        <input type="password" ng-model="password" name="password" class="input-xlarge" localize="placeholder" placeholder="@placeholders_password" autocomplete="off"/>
                    </div>

                    <button type="submit" class="btn" val-trigger-change="#login .form input"><localize key="general_login">Login</localize></button>

                    <div class="control-group" ng-show="loginForm.$invalid">
                        <div class="alert alert-error">{{errorMsg}}</div>
                    </div>

                    <div>
                        <a href="#" prevent-default ng-click="showRequestPasswordReset()" style="color: #fff">Forgotten password?</a>
                    </div>
                </form>
            </div>

            <div ng-show="view == 'request-password-reset'">
                <p>
                    Please enter your email address. If your account is located a link will be sent to you from which you can reset your password.
                </p>

                <form method="POST" name="requestPasswordResetForm" ng-submit="requestPasswordResetSubmit(email)">
                    <div class="control-group" ng-class="{error: requestPasswordResetForm.email.$invalid}">
                        <input type="text" ng-model="email" name="email" class="input-xlarge" placeholder="Email"/>
                    </div>

                    <button type="submit" class="btn" val-trigger-change="#login .form input">Submit</button>

                    <div class="control-group" ng-show="requestPasswordResetForm.$invalid">
                        <div class="alert alert-error">{{errorMsg}}</div>
                    </div>

                    <p class="alert alert-success" ng-show="showEmailResetConfirmation">
                        If your email address has been matched an email with password reset instructions has been sent.
                    </p>

                    <div>
                        <a href="#" prevent-default ng-click="showLogin()" style="color: #fff">Return to login form</a>
                    </div>
                </form>
            </div>

            <div ng-show="view == 'set-password'">
                <p>
                    Please provide a new password.
                </p>

                <form method="POST" name="setPasswordForm" ng-submit="setPasswordSubmit(password, confirmPassword)">

                    <div class="control-group" ng-class="{error: setPasswordForm.password.$invalid}">
                        <input type="password" ng-model="password" name="password" class="input-xlarge" placeholder="Password"/>
                    </div>

                    <div class="control-group" ng-class="{error: setPasswordForm.confirmPassword.$invalid}">
                        <input type="password" ng-model="confirmPassword" name="confirmPassword" class="input-xlarge" placeholder="Confirm password"/>
                    </div>

                    <button type="submit" class="btn" val-trigger-change="#login .form input">Submit</button>

                    <div class="control-group" ng-show="setPasswordForm.$invalid">
                        <div class="alert alert-error">{{errorMsg}}</div>
                    </div>

                    <p class="alert" ng-show="showSetPasswordConfirmation">
                        Your password has been reset and you may now use it to log in.
                    </p>

                    <div>
                        <a href="#" prevent-default ng-click="showLogin()" style="color: #fff">Return to login form</a>
                    </div>
                </form>
            </div>

            <div ng-show="view == 'password-reset-code-expired'">
                <div class="alert alert-error">
                    The link you have clicked on is invalid or has expired.
                </div>
                <div>
                    <a href="#" prevent-default ng-click="showLogin()" style="color: #fff">Return to login form</a>
                </div>
            </div>
        </div>
    </div>
</div>